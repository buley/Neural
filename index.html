<html>
	<head>
		<title>Neural.js</title>
		<!--<link rel="stylesheet" href="/css/style.css">-->
		<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
	</head>
	<body>
		<div id="result"></div>
		<script type="text/javascript">

			function add_data() {

				var count = 3;
				var map = [];
				for( var i = 0; i < count; i++ ) {

					Neural.neurons.add( { 'type': 'hidden', 'slug': InDB.utilities.random( 12, 'letters' ), 'display': InDB.utilities.random( 12, 'letters' ) }, function( context ) {
						var value = InDB.row.value( context );
						console.log( 'Added index @', value );

						var node = Math.floor( Math.random()*100 );	
						Neural.synapses.add( { 'type': 'connection', 'from': value, 'to': node, 'strength': Math.random() }, function( context ) {
							console.log( 'Added synapses from ' + value + ' to ' + node );
						} );

					} );
				}


			}
			$(document).ready(function() {
				var Neural = Neural || {};
				Neural.database_name = "Neural-011";
				Neural.database_description = "Basic MLP neural network."
				var browser_check = InDB.checkBrowser();
				InDB.assert( -1 !== browser_check, 'incompatible browser' );
				if ( 0 === browser_check ) {
					InDB.fixBrowser();
				}
				InDB.debug = true;
				Neural.debug = true;
				var on_loaded = function( context ) {
					jQuery( document ).trigger( 'neuron_database_loaded', context );
				}
				InDB.trigger( 'InDB_do_database_load', { 'name': Neural.database_name, 'description': Neural.database_description, 'on_success': on_loaded } ) ;
			});
	

			jQuery( document ).bind( 'neuron_database_loaded', function( context ) {
				console.log( "Neuron InDB is loaded", context );
				
				add_data();

				var on_success = function( context ) {
					console.log( 'set/getStrength on_success', JSON.stringify( InDB.row.value( context.event ) ) );
				};
				var on_error = function( context ) {
					console.log( 'set/getStrength on_error', context );
				};

				//Neural.synapses.cursor.get( null, 'to', on_success, on_error, 0, null, true, false );
				//Neural.neurons.cursor.get( null, 'type', on_success, on_error, 0, null, true, false );

				/*	
				Neural.synapses.setStrength( {
					'key': 1
					, 'index': 'id'
					, 'strength': ( 1 / 10 )
					, 'on_success': on_success
					, 'on_error': on_error
				} );
				*/
				
				Neural.synapses.getStrength( {
					'key': 1
					, 'index': 'id'
					, 'on_success': on_success
					, 'on_error': on_error
				} );
				
				//console.log( map );

			} );
		</script>
		<script type="text/javascript" src="http://github.com/editor/InDB/raw/master/indb.dev.js"></script>
		<script type="text/javascript" src="https://github.com/editor/Neural/raw/master/neural.dev.js"></script>
	</body>
</html>

